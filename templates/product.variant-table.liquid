{% layout none %}
<table class="variant-table">
  <thead>
    <tr>
      <th scope="col" class="variant-table__header">Color</th>
      <th scope="col" class="variant-table__header visually-hidden">Nombre variante</th>
      <th scope="col" class="variant-table__header">Talla</th>
      <th scope="col" class="variant-table__header">Stock</th>
      <th scope="col" class="variant-table__header">Prox. llegada</th>
      <th scope="col" class="variant-table__header">Avísame</th>
      <th scope="col" class="variant-table__header">Precio con DTO.</th>
      {% if customer.metafields.upng-permission.allowOrder != false %}
        <th scope="col" class="variant-table__header">Cantidad</th>
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for variant in product.variants %}
      <tr class="variant-table__row" data-variant-row="{{ variant.id }}">
        <td class="variant-table__cell">
          {% if variant.featured_image %}
            {{
              variant
              | image_url: width: 50
              | image_tag: class: 'variant-table__image', height: null, loading: 'lazy', alt: variant.title
            }}
          {% else %}
            {{
              product.featured_image
              | image_url: width: 50
              | image_tag: class: 'variant-table__image', height: null, loading: 'lazy', alt: product.title
            }}
          {% endif %}
        </td>
        <td class="variant-table__cell visually-hidden">{{ variant.option1 }}</td>
        <!-- Oculto -->
        <td class="variant-table__cell">{{ variant.option2 }}</td>
        <td class="variant-table__cell variant-table__cell--stock">
          <div class="text-xs product-inventory__status" data-inventory-level="normal">
            {% if variant.inventory_management == 'shopify' %}
              {{ variant.inventory_quantity }}
            {% else %}
              ∞
            {% endif %}
          </div>
        </td>
        {% comment %} PENDIENTE / DATO DE FECHA {% endcomment %}
        <td class="variant-table__cell variant-table__cell--date">31/12/2026</td>
        <td class="variant-table__cell variant-table__cell--status">
          {% if variant.available %}
          {% else %}
            <button class="variant-table__button" variant-id="{{ variant.id }}">
              {% render 'icon', icon: 'upng-avisame', height: 24, width: 24, class: 'variant-table__icon' %}
            </button>
          {% endif %}
        </td>
        <td class="variant-table__cell variant-table__cell--price">
          {% render 'price', product: product, use_variant: true %}
        </td>
        
        {% comment %} Solo mostrar controles de cantidad si el cliente puede hacer pedidos {% endcomment %}
        {% if customer.metafields.upng-permission.allowOrder != false %}
          <td class="variant-table__cell variant-table__cell--quantity">
            <div class="qty-input qty-input--combined inline-flex items-center">
              <button type="button" class="qty-input__btn btn btn--minus no-js-hidden" name="minus">
                <span class="visually-hidden">-</span>
              </button>
              <input
                type="number"
                class="quantity-input variant-table__quantity"
                min="0"
                value="0"
                data-variant-id="{{ variant.id }}"
                data-inventory-quantity="{% if variant.inventory_management == 'shopify' %}{{ variant.inventory_quantity }}{% else %}null{% endif %}"
                data-variant-title="{{ variant.title }}"
                {% unless variant.available %}
                  disabled
                {% endunless %}
                aria-label="Cantidad para {{ variant.title }}"
              >
              <button type="button" class="qty-input__btn btn btn--plus no-js-hidden" name="plus">
                <span class="visually-hidden">+</span>
              </button>
            </div>
            {% comment %} PENDIENTE LOGICA DE ELIMINAR LINEA CARRITO {% endcomment %}
            <a
              class="cart-item__remove btn btn--icon text-current tap-target js-remove-item"
              href="#item.url_to_remove"
              data-index="item.index | plus: 1 "
              aria-label="{{- 'cart.items.remove' | t -}}"
            >
              {% render 'icon-trash' %}
            </a>
          </td>
        {% endif %}
      </tr>
    {% endfor %}
    
    {% comment %} PENDIENTE LOGICA TOTALES TABLA - Solo mostrar si el cliente puede hacer pedidos {% endcomment %}
    {% if customer.metafields.upng-permission.allowOrder != false %}
      <tr>
        <td colspan="3">
          <a
            class="cart-item__remove btn btn--icon text-current tap-target js-remove-item"
            href="#item.url_to_remove"
            data-index="item.index | plus: 1 "
            aria-label="{{- 'cart.items.remove' | t -}}"
          >
            {% render 'icon-trash' %}
            Borrar Todo
          </a>
        </td>
        <td colspan="2"><button class="btn btn-lg btn--secondary">Ver Cesta</button></td>
        <td colspan="2">Subtotal: <b>$$$$</b></td>
        <td colspan="1">Total Items: <b>29</b></td>
      </tr>
    {% else %}
      {% comment %} Fila alternativa cuando no se permite hacer pedidos {% endcomment %}
      <tr>
        <td colspan="7" class="text-center">
          <p class="text-muted">No tienes permisos para realizar pedidos en este momento.</p>
        </td>
      </tr>
    {% endif %}
  </tbody>
</table>